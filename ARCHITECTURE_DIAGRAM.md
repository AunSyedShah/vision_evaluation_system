# Authentication Flow Diagram

## ğŸ” Complete Authentication Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     REACT FRONTEND                              â”‚
â”‚                  (http://localhost:5173)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ axios with JWT interceptors
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  src/utils/api.js                               â”‚
â”‚                                                                 â”‚
â”‚  â€¢ Base URL: https://localhost:7034/api                        â”‚
â”‚  â€¢ Request Interceptor: Add JWT token to headers               â”‚
â”‚  â€¢ Response Interceptor: Handle 401 errors                     â”‚
â”‚  â€¢ Role Mapping: Backend â†” Frontend                            â”‚
â”‚                                                                 â”‚
â”‚    SuperAdmin â†” superadmin                                     â”‚
â”‚    FSO       â†” admin                                           â”‚
â”‚    User      â†” evaluator                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP/HTTPS
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ASP.NET CORE WEB API                               â”‚
â”‚            (https://localhost:7034)                             â”‚
â”‚                                                                 â”‚
â”‚  Controllers:                                                   â”‚
â”‚  â€¢ AuthenticationController                                     â”‚
â”‚    - POST /api/Authentication/register                          â”‚
â”‚    - POST /api/Authentication/verify-otp                        â”‚
â”‚    - POST /api/Authentication/login                             â”‚
â”‚                                                                 â”‚
â”‚  â€¢ ProjectsController [Authorize(Roles="FSO,SuperAdmin")]      â”‚
â”‚    - GET    /api/Projects                                       â”‚
â”‚    - GET    /api/Projects/{id}                                  â”‚
â”‚    - POST   /api/Projects/create                                â”‚
â”‚    - PUT    /api/Projects/{id}                                  â”‚
â”‚    - DELETE /api/Projects/{id}                                  â”‚
â”‚                                                                 â”‚
â”‚  â€¢ SuperAdminController [Authorize(Roles="SuperAdmin")]        â”‚
â”‚    - GET  /api/SuperAdmin/getAllUsers                           â”‚
â”‚    - POST /api/SuperAdmin/assignProject                         â”‚
â”‚                                                                 â”‚
â”‚  Services:                                                      â”‚
â”‚  â€¢ JwtService - Token generation (3 hour expiry)               â”‚
â”‚  â€¢ MailService - SMTP email sending                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Entity Framework Core
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SQL SERVER DATABASE                           â”‚
â”‚                    (VisionDB)                                   â”‚
â”‚                                                                 â”‚
â”‚  Tables:                                                        â”‚
â”‚  â€¢ Users                                                        â”‚
â”‚    - UserId, Username, Email, PasswordHash                      â”‚
â”‚    - OtpCode, OtpExpiration, IsOtpVerified                     â”‚
â”‚    - RoleId (FK)                                               â”‚
â”‚                                                                 â”‚
â”‚  â€¢ Roles                                                        â”‚
â”‚    - RoleId (PK)                                               â”‚
â”‚    - RoleName ('SuperAdmin', 'FSO', 'User')                    â”‚
â”‚                                                                 â”‚
â”‚  â€¢ Projects                                                     â”‚
â”‚    - Id, StartupName, FounderName, Email, etc.                 â”‚
â”‚                                                                 â”‚
â”‚  â€¢ ProjectAssignments                                          â”‚
â”‚    - AssignmentId, ProjectId (FK), UserId (FK)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“§ Registration Flow with OTP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND   â”‚
â”‚  Register    â”‚
â”‚    Page      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. POST /api/Authentication/register
       â”‚    { username, email, password }
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AuthenticationController        â”‚
â”‚                                  â”‚
â”‚  â€¢ Hash password (SHA256)        â”‚
â”‚  â€¢ Create user with role "User"  â”‚
â”‚  â€¢ Generate 6-digit OTP          â”‚
â”‚  â€¢ Set OTP expiration (10 min)   â”‚
â”‚  â€¢ Save to database              â”‚
â”‚  â€¢ Send OTP email via SMTP       â”‚
â”‚  â€¢ Return success message        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 2. Response: "Check your email"
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND   â”‚
â”‚  OTP Input   â”‚
â”‚     Form     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. POST /api/Authentication/verify-otp
       â”‚    { email, otpCode }
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AuthenticationController        â”‚
â”‚                                  â”‚
â”‚  â€¢ Find user by email            â”‚
â”‚  â€¢ Check OTP code match          â”‚
â”‚  â€¢ Check OTP not expired         â”‚
â”‚  â€¢ Set IsOtpVerified = true      â”‚
â”‚  â€¢ Return success message        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 4. Response: "Email verified!"
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND   â”‚
â”‚ Redirect to  â”‚
â”‚    Login     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”‘ Login Flow with JWT

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND   â”‚
â”‚  Login Page  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. POST /api/Authentication/login
       â”‚    { email, password }
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AuthenticationController                â”‚
â”‚                                          â”‚
â”‚  â€¢ Find user by email                    â”‚
â”‚  â€¢ Verify password hash                  â”‚
â”‚  â€¢ Check IsOtpVerified = true            â”‚
â”‚  â€¢ Generate JWT token                    â”‚
â”‚    - Claims: UserId, Username, Email     â”‚
â”‚    - Claims: Role                        â”‚
â”‚    - Expiry: 3 hours                     â”‚
â”‚  â€¢ Return token + user details           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 2. Response:
         â”‚    {
         â”‚      token: "eyJhbGciOi...",
         â”‚      username: "SuperAdmin",
         â”‚      email: "superadmin@vision.com",
         â”‚      role: "SuperAdmin"
         â”‚    }
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  api.js (Frontend)                       â”‚
â”‚                                          â”‚
â”‚  â€¢ Map backend role to frontend role     â”‚
â”‚    SuperAdmin â†’ superadmin               â”‚
â”‚  â€¢ Return mapped user object             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 3. Mapped User:
         â”‚    {
         â”‚      username: "SuperAdmin",
         â”‚      email: "superadmin@vision.com",
         â”‚      role: "superadmin" â† MAPPED
         â”‚    }
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AuthContext                             â”‚
â”‚                                          â”‚
â”‚  â€¢ Store token in localStorage           â”‚
â”‚    localStorage.setItem('token', ...)    â”‚
â”‚  â€¢ Store user in localStorage            â”‚
â”‚    localStorage.setItem('user', ...)     â”‚
â”‚  â€¢ Set currentUser state                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 4. Navigate based on role
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  if (role === 'superadmin')              â”‚
â”‚    â†’ /superadmin/dashboard               â”‚
â”‚  if (role === 'admin')                   â”‚
â”‚    â†’ /admin/dashboard                    â”‚
â”‚  if (role === 'evaluator')               â”‚
â”‚    â†’ /evaluator/dashboard                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›¡ï¸ Protected API Request Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND   â”‚
â”‚ Make API Callâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Example: GET /api/Projects
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  api.js - Request Interceptor           â”‚
â”‚                                          â”‚
â”‚  const token = localStorage.getItem()   â”‚
â”‚  config.headers.Authorization =         â”‚
â”‚    `Bearer ${token}`                     â”‚
â”‚                                          â”‚
â”‚  Request Headers:                        â”‚
â”‚    Authorization: Bearer eyJhbGciOi...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ GET /api/Projects
         â”‚ Header: Authorization: Bearer eyJ...
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ASP.NET Core Middleware                 â”‚
â”‚                                          â”‚
â”‚  â€¢ JWT Authentication Middleware         â”‚
â”‚    - Validate token signature            â”‚
â”‚    - Check token expiration              â”‚
â”‚    - Extract claims (UserId, Role)       â”‚
â”‚  â€¢ Authorization Middleware              â”‚
â”‚    - Check [Authorize] attribute         â”‚
â”‚    - Verify user has required role       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€ âœ… Valid Token + Correct Role
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ProjectsController                      â”‚
â”‚                                          â”‚
â”‚  [Authorize(Roles = "FSO,SuperAdmin")]   â”‚
â”‚  public async Task<IActionResult> Get()  â”‚
â”‚  {                                       â”‚
â”‚    var projects = await _context         â”‚
â”‚      .Projects.ToListAsync();            â”‚
â”‚    return Ok(projects);                  â”‚
â”‚  }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 200 OK
         â”‚ Body: [ { id: 1, ... }, ... ]
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND   â”‚
â”‚ Display Data â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         â”‚
         â””â”€â”€â”€ âŒ Invalid/Expired Token
              â”‚
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  401 Unauthorized Response  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  api.js - Response Interceptor      â”‚
         â”‚                                     â”‚
         â”‚  if (status === 401) {              â”‚
         â”‚    localStorage.removeItem('token') â”‚
         â”‚    localStorage.removeItem('user')  â”‚
         â”‚    window.location.href = '/login'  â”‚
         â”‚  }                                  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Role Authorization Matrix

| Endpoint | SuperAdmin | FSO (Admin) | User (Evaluator) |
|----------|-----------|------------|------------------|
| **Authentication** |
| POST /register | âŒ | âŒ | âœ… Anyone |
| POST /verify-otp | âŒ | âŒ | âœ… Anyone |
| POST /login | âœ… | âœ… | âœ… Anyone |
| **Projects** |
| GET /Projects | âœ… | âœ… | âŒ |
| POST /Projects/create | âœ… | âœ… | âŒ |
| PUT /Projects/{id} | âœ… | âœ… | âŒ |
| DELETE /Projects/{id} | âœ… | âœ… | âŒ |
| **Super Admin** |
| GET /SuperAdmin/getAllUsers | âœ… | âŒ | âŒ |
| POST /SuperAdmin/assignProject | âœ… | âŒ | âŒ |
| **Evaluations** |
| (Not implemented yet) | - | - | - |

---

## ğŸ”„ Token Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         User Logs In                        â”‚
â”‚  â€¢ JWT token generated (3 hour expiry)      â”‚
â”‚  â€¢ Token stored in localStorage             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User Makes API Requests                  â”‚
â”‚  â€¢ Token auto-added to headers              â”‚
â”‚  â€¢ Backend validates token                  â”‚
â”‚  â€¢ Access granted if valid                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â–º Token Still Valid â”€â”€â”€â”€â”€â”
         â”‚                            â”‚
         â”‚                            â–¼
         â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                    â”‚ Continue     â”‚
         â”‚                    â”‚ Using App    â”‚
         â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â”€â”€â–º Token Expired (3+ hours)
               â”‚
               â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Backend Returns 401            â”‚
         â”‚  â€¢ Frontend intercepts          â”‚
         â”‚  â€¢ Remove token from storage    â”‚
         â”‚  â€¢ Redirect to login            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ºï¸ Complete System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER'S BROWSER                              â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  REACT FRONTEND (Vite + React 19 + Tailwind CSS)            â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Components:                                                 â”‚ â”‚
â”‚  â”‚  â€¢ Login.jsx       â†’ Backend login with JWT                 â”‚ â”‚
â”‚  â”‚  â€¢ Register.jsx    â†’ Backend registration + OTP             â”‚ â”‚
â”‚  â”‚  â€¢ AuthContext.jsx â†’ Token management + role mapping        â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Utils:                                                      â”‚ â”‚
â”‚  â”‚  â€¢ api.js          â†’ Axios instance with interceptors       â”‚ â”‚
â”‚  â”‚  â€¢ localStorage.js â†’ Backwards compatibility (seed data)    â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Routes:                                                     â”‚ â”‚
â”‚  â”‚  â€¢ /login          â†’ Public                                 â”‚ â”‚
â”‚  â”‚  â€¢ /register       â†’ Public                                 â”‚ â”‚
â”‚  â”‚  â€¢ /superadmin/*   â†’ Protected (role: superadmin)           â”‚ â”‚
â”‚  â”‚  â€¢ /admin/*        â†’ Protected (role: admin)                â”‚ â”‚
â”‚  â”‚  â€¢ /evaluator/*    â†’ Protected (role: evaluator)            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                   â”‚                                                 â”‚
â”‚                   â”‚ localStorage                                    â”‚
â”‚                   â”‚ â€¢ token: JWT string                             â”‚
â”‚                   â”‚ â€¢ user: { username, email, role }               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ HTTPS Requests
                    â”‚ Authorization: Bearer <token>
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ASP.NET CORE BACKEND                             â”‚
â”‚                    (.NET 8.0 Web API)                               â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MIDDLEWARE PIPELINE                                         â”‚ â”‚
â”‚  â”‚  1. CORS (Allow frontend origin)                             â”‚ â”‚
â”‚  â”‚  2. JWT Authentication (Validate tokens)                     â”‚ â”‚
â”‚  â”‚  3. Authorization (Check roles)                              â”‚ â”‚
â”‚  â”‚  4. Static Files (Serve /Uploads)                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  CONTROLLERS                                                 â”‚ â”‚
â”‚  â”‚  â€¢ AuthenticationController (register, verify-otp, login)    â”‚ â”‚
â”‚  â”‚  â€¢ ProjectsController (CRUD + file upload)                   â”‚ â”‚
â”‚  â”‚  â€¢ SuperAdminController (user management, assignments)       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  SERVICES                                                    â”‚ â”‚
â”‚  â”‚  â€¢ JwtService (Token generation)                             â”‚ â”‚
â”‚  â”‚  â€¢ MailService (SMTP email sending)                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  DATA LAYER                                                  â”‚ â”‚
â”‚  â”‚  â€¢ VisionManagementContext (EF Core DbContext)               â”‚ â”‚
â”‚  â”‚  â€¢ Models: User, Role, Project, ProjectAssignment           â”‚ â”‚
â”‚  â”‚  â€¢ Migrations (Database schema)                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Entity Framework Core
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SQL SERVER                                     â”‚
â”‚                      Database: VisionDB                             â”‚
â”‚                                                                     â”‚
â”‚  Tables:                                                            â”‚
â”‚  â€¢ Users (UserId, Username, Email, PasswordHash, OtpCode, RoleId)  â”‚
â”‚  â€¢ Roles (RoleId, RoleName)                                        â”‚
â”‚  â€¢ Projects (Id, StartupName, FounderName, ...)                    â”‚
â”‚  â€¢ ProjectAssignments (AssignmentId, ProjectId, UserId)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Data Flow Summary

### Authentication:
```
User Input â†’ Frontend â†’ API â†’ Backend â†’ Database â†’ SMTP Email
   â†“
JWT Token â† Frontend â† API â† Backend â† Database
   â†“
localStorage (token + user)
   â†“
Subsequent Requests (token in header)
```

### Role Mapping:
```
Database Role: "SuperAdmin" â†’ Backend API â†’ api.js mapper â†’ "superadmin" â†’ Frontend
Database Role: "FSO"        â†’ Backend API â†’ api.js mapper â†’ "admin"      â†’ Frontend
Database Role: "User"       â†’ Backend API â†’ api.js mapper â†’ "evaluator"  â†’ Frontend
```

### Protected Routes:
```
User Request â†’ Check localStorage token â†’ Add to header â†’ Backend validates
                                                             â†“
                                              âœ… Valid â†’ Access granted
                                              âŒ Invalid/Expired â†’ 401 â†’ Logout â†’ Login
```

---

**Status:** âœ… **AUTHENTICATION FULLY INTEGRATED**
**Date:** October 3, 2025
